# 迁移环境部署前提准备


---

## 1. 安装包下载

请点击获取以下镜像文件并上传至**阿里云平台**：



- [HM_IMG-191227-2020-09-02.qcow2](http://office.oneprocloud.com:18888/iso/hypermotion/%e6%9d%ad%e5%b7%9e%e6%94%bf%e5%8a%a1%e4%ba%91/HM_IMG-191227-2020-03-19.raw)

!> 上传方式请参考阿里文档中的导入自定义镜像[上传自定义镜像](https://help.aliyun.com/document_detail/25464.html?spm=5176.11065259.1996646101.searchclickresult.4b5c780dLB7kN3&aly_as=Fk09A1df)，或联络我们的实施工程师获取共享镜像。

?> **「HyperMotion主控平台」**与 **「HyperGate云端数据代理」**均使用此镜像进行安装部署，具体安装部署操作参照<a href="http://office.oneprocloud.com:18888/iso/hypermotion/%e6%9d%ad%e5%b7%9e%e6%94%bf%e5%8a%a1%e4%ba%91/HM_IMG-191227-2020-03-19.raw" download="HyperMotion-V3-full.raw">迁移安装部署</a>部分的操作说明。

---

## 2.环境及资源准备

?> 请在目标端阿里云平台上确认以下信息：

!> 迁移操作前，请务必完成此步骤，按照以下需求开通网络策略

### 网络资源准备

1. 预定实例「HyperGate云端数据代理」安装所在地域下已创建**专有网络VPC**和**交换机**
2. 预定实例「HyperGate云端数据代理」安装所在地域下已创建**安全组**，</br>
并确保安全组已放行以下端口：18090、3260、1222、222

2. 迁移所需开放的所有网络策略，请按照以下条目进行端口开放

?> **以下代名词说明：** </br>
</br>
**HyperMotion: 迁移主控平台**</br>
**HyperGate: 迁移云端数据代理**</br>
**VCenter/ESXI: 源端VMware环境作为源端进行迁移**</br>
**源端待迁移主机: 安装Agent进行迁移的虚拟机或物理机**</br>

|   | 源端         | 目标端       | 通信方向/开放端口（目标端）                    | 备注                                                         |
| - | -------------- | --------------- | ----------------------------------------------------------- | -------------------------------------------------------------- |
| 1 | HyperMotion    | HyperGate       | 单向：18090、3260、12222、22                               | 迁移组件程序                                             |
| 2 |                | VCenter         | 单向：443                                                | 作为迁移源端：认证端口                              |
| 3 |                | ESXI主机      | 单向：902                                                | 作为迁移源端：数据传输端口                        |
| 4 |                | 源端待迁移主机 | 单向：19981                                              | 源端为Agent方式                                           |
| 5 | HyperGate      | 目标云台API网络 | 单向：5000、35357、9696、8773、8774、8775、8776、9191、9292 | 场景：迁移目标端为私有云 例如：OpenStack，其他私有云视情况而定 |
| 6 | 源端待迁移主机 | HyperGate       | 单向：3260                                               | 源端待迁移主机为Agent方式（物理机、KVM/Xen虚拟机等） |
| 7 |                | HyperMotion     | 单向：18766，10080                                      |                                                                |


### 账户权限开通



1. 该账号已开放所需权限
 
 - 按照条目对迁移账户进行所需权限开放

 |   | 目标云端 | 权限          | 权限条目        | 备注          |
 | - | -------- | --------------- | ------------------- | --------------- |
 | 1 | 阿里云 | 云服务器（ECS） | AliyunECSFullAccess | ECS实例管理权限 |
 | 2 |          | 专有网络（VPC） | AliyunVPCFullAccess | VPC网络管理权限 |



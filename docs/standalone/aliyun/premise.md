# 迁移环境部署前提准备


---

## 1. 安装包下载

请点击获取以下镜像文件并上传至**阿里云平台**：



- [HM_IMG-191227-2020-09-02.qcow2](http://office.oneprocloud.com:18888/iso/hypermotion/%e6%9d%ad%e5%b7%9e%e6%94%bf%e5%8a%a1%e4%ba%91/HM_IMG-191227-2020-03-19.raw)

!> 上传方式请参考阿里文档中的导入自定义镜像[上传自定义镜像](https://help.aliyun.com/document_detail/25464.html?spm=5176.11065259.1996646101.searchclickresult.4b5c780dLB7kN3&aly_as=Fk09A1df)，或联络我们的实施工程师获取共享镜像。

?> **「HyperMotion主控平台」**与 **「HyperGate云端数据代理」**均使用此镜像进行安装部署，具体安装部署操作参照<a href="http://office.oneprocloud.com:18888/iso/hypermotion/%e6%9d%ad%e5%b7%9e%e6%94%bf%e5%8a%a1%e4%ba%91/HM_IMG-191227-2020-03-19.raw" download="HyperMotion-V3-full.raw">迁移安装部署</a>部分的操作说明。

---

## 2.环境及资源准备

?> 请在目标端阿里云平台上确认以下信息：

!> 迁移操作前，请务必完成此步骤，按照以下需求开通网络策略



### 2.1 端口开通


1. 放行迁移所需的所有**端口**，请按照以下条目进行端口开放

2. 预定实例「HyperGate云端数据代理」安装所在地域下已创建**安全组**，并确保安全组已放行以下端口：18090、3260、1222、222

---

### 2.2 网络访问策略开通

?> 迁移所需开放的所有**网络访问策略**，请按照以下条目进行端口开放


|   | 访问端         | 被访问端       | 通信方向/开放端口（被访问端）                    | 备注                                                         |
| - | -------------- | --------------- | ----------------------------------------------------------- | -------------------------------------------------------------- |
| 1 | HyperMotion主机    | HyperGate       | 单向：18090、3260、12222、22                               | 迁移组件程序                                             |
| 2 | HyperMotion主机                | (源)Vcenter        | 单向：443 (VMware场景)                | 作为迁移源端：认证端口                              |
| 3 |HyperMotion主机                | (源)ESXI主机    | 单向：902 (VMware场景)                                               | 作为迁移源端：数据传输端口                        |
| 4 |  HyperMotion主机               | 源端待迁移主机 | 单向：19981       | 源端为Agent方式                                           |
| 5 | HyperGate主机      | 目标云台API网络 | 单向：5000、35357、9696、8773、8774、8775、8776、9191、9292 | **场景：迁移目标端为私有云** 例如：OpenStack，其他私有云视情况而定 |
| 6 | 源端待迁移主机 | HyperGate       | 单向：3260                                               | 源端待迁移主机为Agent方式（物理机、KVM/Xen虚拟机等） |
| 7 |  源端待迁移主机              | HyperMotion     | 单向：18766，10080                                      |                                                                |
| 8 | 操作迁移终端主机   | HyperMotion     | 单向：18088、22  | 迁移软件web浏览器访问以及后台管理远程SSH端口
| 9 | 操作迁移终端主机   | 单向：22   | 单向：22  | 迁移软件web浏览器访问以及后台管理远程SSH端口

---
### 2.3 账户权限开通



 
?>  按照条目对迁移账户进行所需权限开放

 |   | 目标云端 | 权限          | 权限条目        | 备注          |
 | - | -------- | --------------- | ------------------- | --------------- |
 | 1 | 阿里云 | 云服务器（ECS） | AliyunECSFullAccess | ECS实例管理权限 |
 | 2 |          | 专有网络（VPC） | AliyunVPCFullAccess | VPC网络管理权限 |

!> 1.如该账号为主账号，默认已赋予以上权限，请跳过此步骤；</br>
2.如以上权限未开放，请参考阿里文档中[用户权限管理](https://help.aliyun.com/document_detail/64817.html?spm=a2c4g.11186623.4.1.7d0b324dhpn0yW) 中有关为RAM用户、用户组分配授权策略的说明；

